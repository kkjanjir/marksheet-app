<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0"/>
<title>SBS Shiksha Niketan ‚Äì Marksheet</title>
<meta name="theme-color" content="#1a237e"/>
<link rel="manifest" href="manifest.json"/>
<link rel="apple-touch-icon" href="icon-192.png"/>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:'DM Sans',sans-serif;background:#eef0f5;}
.card{background:#fff;border-radius:14px;box-shadow:0 2px 16px rgba(0,0,0,0.07);}
.inp{width:100%;padding:8px 12px;border:1.5px solid #ddd;border-radius:8px;font-size:13px;font-family:'DM Sans',sans-serif;outline:none;background:#fafafa;}
.inp:focus{border-color:#1a237e;background:#fff;}
.mi{width:100%;padding:4px 2px;border:1px solid #ddd;border-radius:4px;font-size:11px;text-align:center;outline:none;font-family:'DM Sans',sans-serif;}
.mi:focus{border-color:#1a237e;background:#eef;}
.btn{border:none;border-radius:8px;padding:8px 16px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;font-size:13px;}
.sug{position:absolute;left:0;right:0;top:100%;background:#fff;border:1.5px solid #ddd;border-top:none;border-radius:0 0 8px 8px;z-index:300;box-shadow:0 8px 20px rgba(0,0,0,0.1);max-height:160px;overflow-y:auto;}
.sug div{padding:9px 12px;cursor:pointer;font-size:13px;border-bottom:1px solid #f0f0f0;}
.sug div:hover{background:#e8eaf6;color:#1a237e;}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
.fi{animation:fadeIn 0.2s ease;}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.3}}
.toast{position:fixed;bottom:72px;left:50%;transform:translateX(-50%);background:#222;color:#fff;padding:10px 22px;border-radius:24px;font-size:13px;z-index:9999;white-space:nowrap;box-shadow:0 4px 20px rgba(0,0,0,0.25);}

/* ===== DESKTOP SPLIT ===== */
@media(min-width:900px){
  .shell{display:flex;height:100vh;overflow:hidden;}
  .epane{width:440px;flex-shrink:0;overflow-y:auto;height:100vh;border-right:1px solid #e0e0e0;background:#eef0f5;}
  .ppane{flex:1;overflow-y:auto;height:100vh;background:#4a4a4a;display:flex;flex-direction:column;align-items:center;padding:16px;}
}
@media(max-width:899px){
  .shell{display:block;}
  .epane{width:100%;}
  .ppane{display:none!important;}
}

/* ===== PRINT ‚Äî SINGLE PAGE, ZERO MARGIN, FULL BLEED ===== */
@media print{
  html,body{margin:0!important;padding:0!important;background:white!important;width:210mm!important;height:297mm!important;}
  body *{visibility:hidden!important;}
  #PA,#PA *{visibility:visible!important;}
  #PA{
    position:fixed!important;
    left:0!important;top:0!important;
    width:210mm!important;height:297mm!important;
    margin:0!important;padding:0!important;
    overflow:hidden!important;
    box-shadow:none!important;
    background:white!important;
  }
  @page{size:A4 portrait;margin:0mm;}
}
</style>
</head>
<body>
<div id="root"></div>

<script>
firebase.initializeApp({
  apiKey:"AIzaSyDw6lVRfXgehqpgvTCobqZZyLAy9alzAU8",
  authDomain:"sbs-marksheet.firebaseapp.com",
  projectId:"sbs-marksheet",
  storageBucket:"sbs-marksheet.firebasestorage.app",
  messagingSenderId:"1064566048496",
  appId:"1:1064566048496:web:0b7cf5d4b9fa0bf9dae435"
});
const db=firebase.firestore();
db.settings({cacheSizeBytes:firebase.firestore.CACHE_SIZE_UNLIMITED});
db.enablePersistence({synchronizeTabs:true}).catch(()=>{});
</script>

<script type="text/babel" data-presets="react">
const {useState,useEffect,useRef}=React;

/* ---------- CONSTANTS ---------- */
// C7: ART AND DRAWING instead of Sanskrit
// C8: MM=60 per subject per term
// C11: pincode 233226
const SNAME="SBS SHIKSHA NIKETAN";
const SADDR="Karaspur Prithvipur, Ghazipur, Uttar Pradesh ‚Äì 233226";
const SLOGO="logo.png";

const SUBJECTS=["HINDI","ENGLISH","MATHEMATICS","SCIENCE","SOCIAL SCIENCE","ART AND DRAWING","COMPUTER","G.K."];

const GRADES=[
  {min:91,max:100,g:"A1",l:"OUTSTANDING"},
  {min:81,max:90,g:"A2",l:"EXCELLENT"},
  {min:71,max:80,g:"B1",l:"VERY GOOD"},
  {min:61,max:70,g:"B2",l:"GOOD"},
  {min:51,max:60,g:"C1",l:"AVERAGE"},
  {min:41,max:50,g:"C2",l:"SATISFACTORY"},
  {min:33,max:40,g:"D",l:"PASS"},
  {min:0,max:32,g:"E",l:"FAIL"},
];
const getG=p=>{if(p===null||isNaN(p))return"-";for(const x of GRADES)if(p>=x.min&&p<=x.max)return x.g;return"-";};
const getL=p=>{if(p===null||isNaN(p))return"-";for(const x of GRADES)if(p>=x.min&&p<=x.max)return x.l;return"-";};

// C4: 5 remark suggestions
const REMARKS_LIST=[
  "Excellent performance, keep it up!",
  "Good effort, needs improvement in weak subjects.",
  "Satisfactory, must work harder next term.",
  "Very good student, maintain regular attendance.",
  "Outstanding achievement, we are proud of you.",
];
// C13: address suggestions
const ADDR_LIST=[
  "Nasiruddinpur, Prithvipur, Ghazipur, Uttar Pradesh 233226",
  "Prithvipur, Ghazipur, Uttar Pradesh 233226",
  "Karaspur, Prithvipur, Ghazipur, Uttar Pradesh 233226",
];

/* ---------- CALC ---------- */
const sTot=s=>(parseFloat(s.obt1)||0)+(parseFloat(s.obt2)||0)+(parseFloat(s.obt3)||0);
const sMM=s=>(parseFloat(s.mm1)||0)+(parseFloat(s.mm2)||0)+(parseFloat(s.mm3)||0);
function gTot(subs){return subs.reduce((a,s)=>{
  a.mm1+=parseFloat(s.mm1)||0;a.obt1+=parseFloat(s.obt1)||0;
  a.mm2+=parseFloat(s.mm2)||0;a.obt2+=parseFloat(s.obt2)||0;
  a.mm3+=parseFloat(s.mm3)||0;a.obt3+=parseFloat(s.obt3)||0;
  a.mmG+=sMM(s);a.obtG+=sTot(s);return a;
},{mm1:0,obt1:0,mm2:0,obt2:0,mm3:0,obt3:0,mmG:0,obtG:0});}
const calcP=(o,m)=>m?parseFloat(((o/m)*100).toFixed(1)):null;

/* ---------- FIREBASE ---------- */
const fbSave=async st=>{
  await db.collection("students").doc(String(st.id)).set(st);
  const ref=db.collection("backups").doc(String(st.id));
  const ex=await ref.get();
  let v=ex.exists?ex.data().versions||[]:[];
  v=[{...st,_at:new Date().toISOString()},...v].slice(0,2);
  await ref.set({versions:v});
};
const fbAll=async()=>(await db.collection("students").get()).docs.map(d=>d.data());
const fbDel=async id=>db.collection("students").doc(String(id)).delete();
const fbBk=async id=>{const d=await db.collection("backups").doc(String(id)).get();return d.exists?d.data().versions||[]:[];};

/* ---------- LOCAL STORAGE ---------- */
const LS="sbs5";
const lsS=d=>{try{localStorage.setItem(LS,JSON.stringify(d));}catch{}};
const lsL=()=>{try{const r=localStorage.getItem(LS);return r?JSON.parse(r):[];}catch{return[];}};

/* ---------- NEW STUDENT ---------- */
const newSt=()=>({
  id:Date.now()+"_"+Math.random().toString(36).slice(2,7),
  name:"",father:"",mother:"",address:"",
  roll:"",admission:"",dob:"",cls:"",section:"",session:"2025-26",
  photo:null,
  att:{present:"",total:""},
  remarks:"",rank:"",
  // C8: mm=60
  subjects:SUBJECTS.map(n=>({name:n,mm1:60,obt1:"",mm2:60,obt2:"",mm3:60,obt3:""})),
  coscho:{sports:"",art:"",music:"",discipline:"",cleanliness:""},
  _c:new Date().toISOString(),_u:new Date().toISOString(),
});

/* ---------- MINI ICONS ---------- */
const I={
  back:<svg width="18" height="18" fill="none" stroke="currentColor" strokeWidth="2.5" viewBox="0 0 24 24"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>,
  add:<svg width="16" height="16" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>,
  print:<svg width="16" height="16" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>,
  del:<svg width="15" height="15" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6M14 11v6M9 6V4h6v2"/></svg>,
  search:<svg width="15" height="15" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>,
  up:<svg width="14" height="14" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><polyline points="16 16 12 12 8 16"/><line x1="12" y1="12" x2="12" y2="21"/><path d="M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"/></svg>,
  hist:<svg width="14" height="14" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 .49-4.95"/></svg>,
};

/* ---------- TOAST ---------- */
function Toast({m}){return m?<div className="toast">{m}</div>:null;}

/* ---------- SYNC BAR ---------- */
function SyncBar({st,ts}){
  const c={synced:"#4caf50",syncing:"#ff9800",error:"#f44336",offline:"#9e9e9e",idle:"#bbb"};
  const l={synced:"Synced to Firebase ‚úì",syncing:"Saving‚Ä¶",error:"Sync failed ‚Äì saved locally",offline:"Offline ‚Äì local storage active",idle:"Ready"};
  return(
    <div style={{background:"#f5f7ff",borderBottom:"1px solid #e0e4f0",padding:"4px 14px",display:"flex",alignItems:"center",fontSize:11,color:"#666",gap:6}}>
      <span style={{width:8,height:8,borderRadius:"50%",background:c[st]||"#bbb",display:"inline-block",animation:st==="syncing"?"pulse 1s infinite":""}}></span>
      <span>{l[st]||"Ready"}</span>
      {ts&&st==="synced"&&<span style={{marginLeft:"auto",color:"#aaa"}}>{ts}</span>}
    </div>
  );
}

/* ---------- DASHBOARD ---------- */
function Dashboard({students,onNew,onSel,syncSt,syncTs}){
  const [q,setQ]=useState("");
  const list=students.filter(s=>(s.name||"").toLowerCase().includes(q.toLowerCase())||(s.roll||"").includes(q)||(s.cls||"").includes(q));
  const passed=students.filter(s=>{const g=gTot(s.subjects);return g.mmG>0&&calcP(g.obtG,g.mmG)>=33;}).length;
  const cls=[...new Set(students.map(s=>s.cls).filter(Boolean))].length;
  return(
    <div className="fi">
      <SyncBar st={syncSt} ts={syncTs}/>
      <div style={{padding:14,paddingBottom:80}}>
        {/* Header card */}
        <div className="card" style={{padding:18,marginBottom:14,textAlign:"center",background:"linear-gradient(135deg,#0d1b6e,#1a237e)"}}>
          <div style={{fontSize:10,letterSpacing:3,color:"rgba(255,255,255,0.6)",fontWeight:600,marginBottom:3,fontFamily:"DM Sans"}}>SCHOOL MANAGEMENT SYSTEM</div>
          <div style={{fontSize:20,fontWeight:800,color:"#fff",fontFamily:"Playfair Display,serif"}}>{SNAME}</div>
          <div style={{fontSize:10,color:"#90caf9",marginTop:2}}>{SADDR}</div>
          <div style={{marginTop:12,display:"flex",justifyContent:"center",gap:10}}>
            {[[students.length,"Students","#fff"],[passed,"Passed","#a5d6a7"],[cls,"Classes","#ffcc80"]].map(([v,l,c])=>(
              <div key={l} style={{background:"rgba(255,255,255,0.12)",borderRadius:10,padding:"8px 14px",textAlign:"center"}}>
                <div style={{fontSize:22,fontWeight:800,color:c}}>{v}</div>
                <div style={{fontSize:10,color:"#90caf9"}}>{l}</div>
              </div>
            ))}
          </div>
        </div>
        {/* Search + Add */}
        <div style={{display:"flex",gap:10,marginBottom:14}}>
          <div style={{flex:1,position:"relative"}}>
            <span style={{position:"absolute",left:10,top:"50%",transform:"translateY(-50%)",color:"#aaa"}}>{I.search}</span>
            <input value={q} onChange={e=>setQ(e.target.value)} placeholder="Search name, class, roll‚Ä¶" className="inp" style={{paddingLeft:32}}/>
          </div>
          <button onClick={onNew} className="btn" style={{background:"#1a237e",color:"#fff",display:"flex",alignItems:"center",gap:6}}>
            {I.add} New
          </button>
        </div>
        {/* List */}
        {list.length===0?(
          <div className="card" style={{padding:40,textAlign:"center"}}>
            <div style={{fontSize:44,marginBottom:8}}>üìã</div>
            <div style={{color:"#555",fontWeight:600}}>No students found</div>
            <div style={{color:"#aaa",fontSize:12,marginTop:4}}>Tap "New" to add</div>
          </div>
        ):(
          <div style={{display:"flex",flexDirection:"column",gap:10}}>
            {list.map(s=>{
              const g=gTot(s.subjects);
              const p=g.mmG>0?calcP(g.obtG,g.mmG):null;
              const pass=p!==null&&p>=33;
              return(
                <div key={s.id} onClick={()=>onSel(s.id)} className="card"
                  style={{padding:"12px 14px",display:"flex",alignItems:"center",gap:12,cursor:"pointer"}}>
                  <div style={{width:44,height:44,borderRadius:10,overflow:"hidden",background:"#e8eaf6",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center"}}>
                    {s.photo?<img src={s.photo} style={{width:"100%",height:"100%",objectFit:"cover"}}/>:<span style={{fontSize:20}}>üë§</span>}
                  </div>
                  <div style={{flex:1,minWidth:0}}>
                    <div style={{fontWeight:700,fontSize:14,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{s.name||"Unnamed"}</div>
                    <div style={{fontSize:11,color:"#888",marginTop:1}}>
                      Class <b>{s.cls||"?"}{s.section?"-"+s.section:""}</b>
                      {s.roll&&<> ¬∑ Roll <b>{s.roll}</b></>}
                      {s.session&&<> ¬∑ {s.session}</>}
                    </div>
                  </div>
                  {p!==null&&(
                    <div style={{textAlign:"right",flexShrink:0}}>
                      <div style={{fontWeight:800,fontSize:15,color:pass?"#2e7d32":"#c62828"}}>{p}%</div>
                      <span style={{background:pass?"#e8f5e9":"#ffebee",color:pass?"#2e7d32":"#c62828",padding:"1px 8px",borderRadius:20,fontSize:11,fontWeight:700}}>{getG(p)}</span>
                    </div>
                  )}
                </div>
              );
            })}
          </div>
        )}
      </div>
    </div>
  );
}

/* ---------- EDITOR ---------- */
function Editor({student,onSave,onBack,onPrint,onDel,toast}){
  const [s,setS]=useState(()=>JSON.parse(JSON.stringify(student)));
  const [bks,setBks]=useState([]);
  const [showBk,setShowBk]=useState(false);
  const [showAddrSug,setShowAddrSug]=useState(false);
  const [showRemSug,setShowRemSug]=useState(false);
  const photoRef=useRef();
  const timer=useRef();

  // Auto save 1.5s after last change
  useEffect(()=>{
    clearTimeout(timer.current);
    timer.current=setTimeout(()=>onSave(s),1500);
    return()=>clearTimeout(timer.current);
  },[s]);

  const upd=(f,v)=>setS(p=>({...p,[f]:v,_u:new Date().toISOString()}));
  const updS=(i,f,v)=>{const a=[...s.subjects];a[i]={...a[i],[f]:v};setS(p=>({...p,subjects:a,_u:new Date().toISOString()}));};
  const addSub=()=>setS(p=>({...p,subjects:[...p.subjects,{name:"",mm1:60,obt1:"",mm2:60,obt2:"",mm3:60,obt3:""}]}));
  const remSub=i=>setS(p=>({...p,subjects:p.subjects.filter((_,j)=>j!==i)}));

  const handlePhoto=e=>{
    const f=e.target.files[0];if(!f)return;
    if(f.size>600000){toast("‚ö†Ô∏è Photo too large! Max 600KB");return;}
    const r=new FileReader();r.onload=ev=>setS(p=>({...p,photo:ev.target.result}));r.readAsDataURL(f);
  };

  // C13: clamp marks between 0 and MM
  const clampMark=(v,mm)=>{
    if(v==="")return "";
    let n=parseFloat(v);
    if(isNaN(n))return "";
    if(n<0)n=0;
    const max=parseFloat(mm)||60;
    if(n>max)n=max;
    return String(n);
  };

  const gt=gTot(s.subjects);
  const op=gt.mmG>0?calcP(gt.obtG,gt.mmG):null;
  const pass=op!==null&&op>=33;
  const attDisp=s.att.present&&s.att.total?((s.att.present/s.att.total)*100).toFixed(0)+"%":"";

  const addrMatches=ADDR_LIST.filter(a=>a.toLowerCase().includes((s.address||"").toLowerCase())&&(s.address||"").length>1);

  return(
    <div className="fi" style={{paddingBottom:90}}>
      {/* Top bar */}
      <div style={{background:"linear-gradient(135deg,#1a237e,#283593)",padding:"12px 14px",display:"flex",alignItems:"center",gap:10,position:"sticky",top:0,zIndex:50}}>
        <button onClick={onBack} className="btn" style={{background:"rgba(255,255,255,0.15)",color:"#fff",padding:"7px 11px",display:"flex",alignItems:"center"}}>{I.back}</button>
        <div style={{flex:1,overflow:"hidden"}}>
          <div style={{color:"#fff",fontWeight:700,fontSize:14,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{s.name||"New Student"}</div>
          <div style={{color:"#90caf9",fontSize:11}}>{s.cls?"Class "+s.cls+(s.section?"-"+s.section:""):""} {s.session}</div>
        </div>
        <button onClick={async()=>{const bk=await fbBk(s.id);setBks(bk);setShowBk(true);}} className="btn" style={{background:"rgba(255,255,255,0.12)",color:"#fff",padding:"7px 10px",display:"flex",alignItems:"center",gap:4,fontSize:11}}>{I.hist}</button>
        <button onClick={()=>{onSave(s);onPrint(s);}} className="btn" style={{background:"#c62828",color:"#fff",display:"flex",alignItems:"center",gap:5}}>
          {I.print} Print
        </button>
      </div>
      <div style={{background:"#fffde7",borderBottom:"1px solid #fff9c4",padding:"4px 14px",fontSize:11,color:"#f57f17"}}>‚ö° Auto-saving to Firebase</div>

      <div style={{padding:14,display:"flex",flexDirection:"column",gap:12}}>

        {/* Score banner */}
        {op!==null&&(
          <div style={{background:pass?"#e8f5e9":"#ffebee",border:`1.5px solid ${pass?"#a5d6a7":"#ef9a9a"}`,borderRadius:12,padding:"12px 16px",display:"flex",justifyContent:"space-between",alignItems:"center"}}>
            <div>
              <div style={{fontSize:11,color:"#666"}}>Overall Score</div>
              <div style={{fontSize:20,fontWeight:800,color:pass?"#2e7d32":"#c62828"}}>{gt.obtG}/{gt.mmG}</div>
            </div>
            <div style={{textAlign:"right"}}>
              <div style={{fontSize:26,fontWeight:900,color:pass?"#1b5e20":"#b71c1c"}}>{op}%</div>
              <span style={{background:pass?"#2e7d32":"#c62828",color:"#fff",padding:"2px 12px",borderRadius:20,fontSize:12,fontWeight:700}}>{getG(op)} ‚Äì {getL(op)}</span>
            </div>
          </div>
        )}

        {/* Backups panel */}
        {showBk&&(
          <div className="card" style={{padding:14}}>
            <div style={{display:"flex",justifyContent:"space-between",marginBottom:10}}>
              <b style={{fontSize:13}}>üìÇ Last 2 Backups</b>
              <button onClick={()=>setShowBk(false)} style={{background:"none",border:"none",cursor:"pointer",fontSize:18,color:"#888"}}>‚úï</button>
            </div>
            {bks.length===0?<div style={{color:"#aaa",fontSize:13}}>No backups yet</div>:bks.map((b,i)=>(
              <div key={i} style={{border:"1px solid #eee",borderRadius:8,padding:"10px 12px",marginBottom:8,display:"flex",justifyContent:"space-between",alignItems:"center"}}>
                <div>
                  <div style={{fontWeight:600,fontSize:13}}>{i===0?"üïê Latest":"üïë Previous"} Backup</div>
                  <div style={{fontSize:11,color:"#888"}}>{b._at?new Date(b._at).toLocaleString("en-IN"):""}</div>
                </div>
                <button onClick={()=>{setS(b);setShowBk(false);toast("‚úÖ Restored!");}} className="btn" style={{background:"#1a237e",color:"#fff",fontSize:12,padding:"6px 12px"}}>Restore</button>
              </div>
            ))}
          </div>
        )}

        {/* Student info */}
        <div className="card" style={{padding:14}}>
          <div style={{fontWeight:700,fontSize:13,marginBottom:12}}>üë§ Student Information</div>
          <div style={{display:"flex",gap:12,marginBottom:10}}>
            {/* Photo upload */}
            <div onClick={()=>photoRef.current.click()} style={{width:80,height:96,border:"2px dashed #9fa8da",borderRadius:8,cursor:"pointer",overflow:"hidden",background:"#f5f7ff",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0}}>
              {s.photo?<img src={s.photo} style={{width:"100%",height:"100%",objectFit:"cover"}}/>:<div style={{textAlign:"center",fontSize:11,color:"#aaa",padding:4}}>{I.up}<br/>Photo</div>}
            </div>
            <input ref={photoRef} type="file" accept="image/*" style={{display:"none"}} onChange={handlePhoto}/>
            <div style={{flex:1,display:"flex",flexDirection:"column",gap:7}}>
              <input className="inp" placeholder="Student Full Name *" value={s.name} onChange={e=>upd("name",e.target.value)}/>
              <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:7}}>
                <input className="inp" placeholder="Class (e.g. 5)" value={s.cls} onChange={e=>upd("cls",e.target.value)}/>
                <input className="inp" placeholder="Section (A/B)" value={s.section} onChange={e=>upd("section",e.target.value)}/>
              </div>
            </div>
          </div>
          <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:7}}>
            <input className="inp" placeholder="Father's Name" value={s.father} onChange={e=>upd("father",e.target.value)}/>
            <input className="inp" placeholder="Mother's Name" value={s.mother} onChange={e=>upd("mother",e.target.value)}/>
            <input className="inp" placeholder="Roll No." value={s.roll} onChange={e=>upd("roll",e.target.value)}/>
            <input className="inp" placeholder="Admission No." value={s.admission} onChange={e=>upd("admission",e.target.value)}/>
            {/* C13: DOB min 1999 */}
            <input className="inp" type="date" value={s.dob} min="1999-01-01" max={new Date().toISOString().split("T")[0]} onChange={e=>upd("dob",e.target.value)}/>
            <input className="inp" placeholder="Session e.g. 2025-26" value={s.session} onChange={e=>upd("session",e.target.value)}/>
            {/* C13: Address with suggestions */}
            <div style={{gridColumn:"span 2",position:"relative"}}>
              <input className="inp" placeholder="Address" value={s.address||""} onChange={e=>{upd("address",e.target.value);setShowAddrSug(true);}} onBlur={()=>setTimeout(()=>setShowAddrSug(false),200)}/>
              {showAddrSug&&addrMatches.length>0&&(
                <div className="sug">
                  {addrMatches.map((a,i)=><div key={i} onMouseDown={()=>{upd("address",a);setShowAddrSug(false);}}>{a}</div>)}
                </div>
              )}
            </div>
          </div>
        </div>

        {/* Attendance */}
        <div className="card" style={{padding:14}}>
          <div style={{fontWeight:700,fontSize:13,marginBottom:10}}>üìÖ Attendance</div>
          <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8}}>
            <div>
              <label style={{fontSize:11,color:"#888"}}>Days Present</label>
              <input className="inp" type="number" min="0" placeholder="e.g. 210" value={s.att.present} onChange={e=>setS(p=>({...p,att:{...p.att,present:e.target.value}}))}/>
            </div>
            <div>
              <label style={{fontSize:11,color:"#888"}}>Total Working Days</label>
              <input className="inp" type="number" min="0" placeholder="e.g. 240" value={s.att.total} onChange={e=>setS(p=>({...p,att:{...p.att,total:e.target.value}}))}/>
            </div>
          </div>
          {s.att.present&&s.att.total&&<div style={{marginTop:6,fontSize:12,color:"#2e7d32",fontWeight:600}}>üìä {attDisp} Attendance</div>}
        </div>

        {/* Marks */}
        <div className="card" style={{padding:14}}>
          <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10}}>
            <div style={{fontWeight:700,fontSize:13}}>üìä Marks ‚Äì 3 Terms (MM: 60)</div>
            <button onClick={addSub} className="btn" style={{background:"#e3f2fd",color:"#1565c0",padding:"5px 12px",fontSize:12}}>+ Add</button>
          </div>
          <div style={{overflowX:"auto"}}>
            <table style={{width:"100%",borderCollapse:"collapse",fontSize:11,minWidth:480}}>
              <thead>
                <tr style={{background:"#e8eaf6"}}>
                  <th style={{padding:"6px 4px",textAlign:"left",minWidth:80}}>Subject</th>
                  <th colSpan="2" style={{padding:5,color:"#1a237e",fontSize:10}}>Term 1</th>
                  <th colSpan="2" style={{padding:5,color:"#1a237e",fontSize:10}}>Term 2</th>
                  <th colSpan="2" style={{padding:5,color:"#1a237e",fontSize:10}}>Term 3</th>
                  <th style={{padding:5,color:"#c62828",fontSize:10}}>Total</th>
                  <th style={{padding:5,color:"#2e7d32",fontSize:10}}>%</th>
                  <th style={{padding:5,color:"#6a1b9a",fontSize:10}}>Grd</th>
                  <th style={{width:20}}></th>
                </tr>
                <tr style={{background:"#f0f2ff",fontSize:10}}>
                  <th></th>
                  <th style={{padding:"2px",color:"#888",fontWeight:500}}>MM</th><th style={{padding:"2px"}}>Obt</th>
                  <th style={{padding:"2px",color:"#888",fontWeight:500}}>MM</th><th style={{padding:"2px"}}>Obt</th>
                  <th style={{padding:"2px",color:"#888",fontWeight:500}}>MM</th><th style={{padding:"2px"}}>Obt</th>
                  <th></th><th></th><th></th><th></th>
                </tr>
              </thead>
              <tbody>
                {s.subjects.map((sub,i)=>{
                  const tot=sTot(sub),mm=sMM(sub);
                  const p=mm>0?calcP(tot,mm):null;
                  const pass=p!==null&&p>=33;
                  return(
                    <tr key={i} style={{borderBottom:"1px solid #eee",background:i%2===0?"#fafafa":"#fff"}}>
                      <td style={{padding:"2px"}}><input className="mi" style={{textAlign:"left",fontWeight:600,minWidth:75}} value={sub.name} onChange={e=>updS(i,"name",e.target.value)}/></td>
                      <td style={{padding:"2px"}}><input className="mi" style={{width:32,background:"#e3f2fd"}} value={sub.mm1} onChange={e=>updS(i,"mm1",e.target.value)}/></td>
                      <td style={{padding:"2px"}}><input className="mi" style={{width:32}} value={sub.obt1} onChange={e=>updS(i,"obt1",clampMark(e.target.value,sub.mm1))}/></td>
                      <td style={{padding:"2px"}}><input className="mi" style={{width:32,background:"#e3f2fd"}} value={sub.mm2} onChange={e=>updS(i,"mm2",e.target.value)}/></td>
                      <td style={{padding:"2px"}}><input className="mi" style={{width:32}} value={sub.obt2} onChange={e=>updS(i,"obt2",clampMark(e.target.value,sub.mm2))}/></td>
                      <td style={{padding:"2px"}}><input className="mi" style={{width:32,background:"#e3f2fd"}} value={sub.mm3} onChange={e=>updS(i,"mm3",e.target.value)}/></td>
                      <td style={{padding:"2px"}}><input className="mi" style={{width:32}} value={sub.obt3} onChange={e=>updS(i,"obt3",clampMark(e.target.value,sub.mm3))}/></td>
                      <td style={{padding:"3px 4px",fontWeight:700,color:"#c62828",textAlign:"center"}}>{mm>0?tot:""}</td>
                      <td style={{padding:"3px 4px",textAlign:"center",fontWeight:600,color:pass?"#2e7d32":"#c62828"}}>{p!==null?p+"%":""}</td>
                      <td style={{padding:"3px 4px",textAlign:"center"}}>{p!==null&&<span style={{background:pass?"#e8f5e9":"#ffebee",color:pass?"#2e7d32":"#c62828",padding:"1px 5px",borderRadius:8,fontSize:11,fontWeight:700}}>{getG(p)}</span>}</td>
                      <td><button onClick={()=>remSub(i)} style={{background:"none",border:"none",cursor:"pointer",color:"#e57373"}}>{I.del}</button></td>
                    </tr>
                  );
                })}
                <tr style={{background:"#e8eaf6",fontWeight:800,fontSize:12}}>
                  <td style={{padding:"5px 4px"}}>TOTAL</td>
                  <td style={{textAlign:"center",color:"#666"}}>{gt.mm1}</td><td style={{textAlign:"center"}}>{gt.obt1||0}</td>
                  <td style={{textAlign:"center",color:"#666"}}>{gt.mm2}</td><td style={{textAlign:"center"}}>{gt.obt2||0}</td>
                  <td style={{textAlign:"center",color:"#666"}}>{gt.mm3}</td><td style={{textAlign:"center"}}>{gt.obt3||0}</td>
                  <td style={{textAlign:"center",color:"#c62828"}}>{gt.obtG}/{gt.mmG}</td>
                  <td style={{textAlign:"center",color:pass?"#2e7d32":"#c62828"}}>{op}%</td>
                  <td style={{textAlign:"center"}}><span style={{background:"#1a237e",color:"#fff",padding:"1px 6px",borderRadius:8,fontSize:11}}>{op!==null?getG(op):""}</span></td>
                  <td></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        {/* Co-scholastic */}
        <div className="card" style={{padding:14}}>
          <div style={{fontWeight:700,fontSize:13,marginBottom:10}}>üé® Co-Scholastic (A+/A/B+/B/C)</div>
          <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8}}>
            {[["sports","‚öΩ Sports"],["art","üé® Art & Craft"],["music","üéµ Music"],["discipline","üìê Discipline"],["cleanliness","‚ú® Cleanliness"]].map(([k,l])=>(
              <div key={k}>
                <label style={{fontSize:11,color:"#888"}}>{l}</label>
                <select className="inp" value={s.coscho[k]} onChange={e=>setS(p=>({...p,coscho:{...p.coscho,[k]:e.target.value}}))}>
                  <option value="">‚Äì Select ‚Äì</option>
                  {["A+","A","B+","B","C"].map(g=><option key={g}>{g}</option>)}
                </select>
              </div>
            ))}
          </div>
        </div>

        {/* Remarks + Rank */}
        <div className="card" style={{padding:14}}>
          <div style={{fontWeight:700,fontSize:13,marginBottom:10}}>‚úèÔ∏è Remarks & Rank</div>
          <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:8}}>
            <div>
              <label style={{fontSize:11,color:"#888"}}>Class Rank</label>
              <input className="inp" placeholder="e.g. 3" value={s.rank||""} onChange={e=>upd("rank",e.target.value)}/>
            </div>
            <div>
              <label style={{fontSize:11,color:"#888"}}>Attendance</label>
              <input className="inp" readOnly value={attDisp} style={{background:"#f5f5f5"}}/>
            </div>
          </div>
          {/* C4: Remark with 5 suggestions */}
          <label style={{fontSize:11,color:"#888"}}>Teacher's Remark (tap for suggestions)</label>
          <div style={{position:"relative"}}>
            <textarea className="inp" rows="2" placeholder="Tap to see suggestions or type custom‚Ä¶" value={s.remarks||""} onChange={e=>upd("remarks",e.target.value)} onFocus={()=>setShowRemSug(true)} onBlur={()=>setTimeout(()=>setShowRemSug(false),200)} style={{resize:"none",marginTop:4}}/>
            {showRemSug&&(
              <div className="sug">
                {REMARKS_LIST.map((r,i)=><div key={i} onMouseDown={()=>{upd("remarks",r);setShowRemSug(false);}}>{r}</div>)}
                <div style={{color:"#aaa",fontStyle:"italic"}} onMouseDown={()=>setShowRemSug(false)}>‚úèÔ∏è Type custom remark‚Ä¶</div>
              </div>
            )}
          </div>
        </div>

        <button onClick={onDel} className="btn" style={{width:"100%",background:"#fff5f5",color:"#c62828",border:"1.5px solid #ffcdd2",fontSize:13}}>
          üóëÔ∏è Delete This Student
        </button>
      </div>
    </div>
  );
}

/* ---------- MARKSHEET PRINT ---------- */
function PrintView({student:s,onClose}){
  const gt=gTot(s.subjects);
  const op=gt.mmG>0?calcP(gt.obtG,gt.mmG):null;
  // C6: No result PASS/FAIL shown
  const attDisp=s.att.present&&s.att.total
    ?((s.att.present/s.att.total)*100).toFixed(0)+"%"
    :(s.att.present||"");
  // C3: only pad up to 8 rows, no extra blank rows
  const pad=Math.max(0,8-s.subjects.length);

  const TD=(props)=><td style={{border:"1px solid #000",textAlign:"center",...props.s}}>{props.c}</td>;
  const TH=(props)=><th style={{border:"1px solid #000",...props.s}}>{props.c}</th>;

  return(
    <div className="fi">
      {/* Screen-only controls */}
      <div style={{background:"#1a237e",padding:"12px 14px",display:"flex",alignItems:"center",gap:10,position:"sticky",top:0,zIndex:50}}>
        <button onClick={onClose} className="btn" style={{background:"rgba(255,255,255,0.15)",color:"#fff",display:"flex",alignItems:"center",gap:5}}>{I.back} Back</button>
        <div style={{flex:1,color:"#fff",fontWeight:600,fontSize:13,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{s.name} ‚Äì Marksheet Preview</div>
        <button onClick={()=>window.print()} className="btn" style={{background:"#c62828",color:"#fff",display:"flex",alignItems:"center",gap:5}}>{I.print} Print / Save PDF</button>
      </div>
      <div style={{background:"#fff8e1",padding:"6px 14px",fontSize:12,color:"#e65100",textAlign:"center"}}>
        üí° Chrome ‚Üí Print ‚Üí "Save as PDF" ‚Üí Destination: Save as PDF ‚Üí Print
      </div>

      {/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
          THE ACTUAL A4 MARKSHEET
          width=210mm, height=297mm, padding=0
          Red border goes edge to edge (margin inside)
      ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */}
      <div id="PA" style={{
        width:"210mm",height:"297mm",
        background:"white",
        margin:"0 auto",
        padding:0,
        overflow:"hidden",
        fontFamily:"Arial,sans-serif",
        display:"flex",
        flexDirection:"column",
      }}>
        {/* Red outer border ‚Äî 5mm margin all sides inside page */}
        <div style={{
          border:"4px solid #c62828",
          margin:"5mm",
          flex:1,
          display:"flex",
          flexDirection:"column",
          overflow:"hidden",
        }}>
          <div style={{
            border:"1.5px solid #000",
            margin:"2px",
            flex:1,
            display:"flex",
            flexDirection:"column",
            padding:"5px 7px",
            overflow:"hidden",
          }}>

            {/* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */}
            <div style={{display:"flex",alignItems:"flex-start",gap:6,marginBottom:5}}>
              {/* Logo ‚Äî C10: slightly inset, not flush corner */}
              <div style={{width:82,height:82,border:"1px solid #ccc",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,marginTop:6,marginLeft:2}}>
                <img src={SLOGO} style={{width:"100%",height:"100%",objectFit:"contain"}} alt="logo"
                  onError={e=>{e.target.style.display="none";e.target.parentNode.innerHTML='<span style="font-size:8px;color:#aaa;text-align:center;padding:4px">SCHOOL<br/>LOGO</span>';}}/>
              </div>

              {/* Centre header */}
              <div style={{flex:1,textAlign:"center",padding:"0 8px"}}>
                <div style={{fontSize:24,fontWeight:900,color:"#c62828",fontFamily:'"Times New Roman",serif',textTransform:"uppercase",letterSpacing:0.5,lineHeight:1.15}}>{SNAME}</div>
                {/* C11: address with pincode */}
                <div style={{fontSize:10,fontWeight:700,color:"#111",marginTop:2}}>{SADDR}</div>
                <div style={{display:"inline-block",background:"#ffff00",color:"#c62828",padding:"2px 14px",fontWeight:900,fontSize:11.5,borderBottom:"2px solid #c62828",textDecoration:"underline",marginTop:5,marginBottom:3}}>
                  PROGRESS EVALUATION REPORT
                </div>
                {/* C2: Academic Session, then Class below it */}
                <div style={{fontSize:11,fontWeight:700,color:"#1a237e",marginTop:2}}>
                  ACADEMIC SESSION : <span style={{color:"#000"}}>{s.session}</span>
                </div>
                <div style={{fontSize:12,fontWeight:900,color:"#000",fontFamily:'"Times New Roman",serif',marginTop:1}}>
                  CLASS : {s.cls}{s.section?"-"+s.section:""}
                </div>
              </div>

              {/* C10: Photo ‚Äî marginTop:10 so it sits a bit lower, marginRight:3 so not flush */}
              <div style={{width:74,height:88,border:"1.5px solid #000",flexShrink:0,overflow:"hidden",background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center",marginTop:10,marginRight:3}}>
                {s.photo?<img src={s.photo} style={{width:"100%",height:"100%",objectFit:"cover"}}/>:<span style={{fontSize:9,color:"#aaa"}}>Photo</span>}
              </div>
            </div>

            {/* ‚îÄ‚îÄ STUDENT INFO BOX ‚îÄ‚îÄ */}
            {/* C9: Roll/Adm/DOB left-aligned with fixed label width */}
            <div style={{background:"#d1eeee",borderTop:"2px solid #000",borderBottom:"2px solid #000",padding:"5px 8px",marginBottom:5,fontFamily:'"Times New Roman",serif',fontSize:10.5,fontWeight:700}}>
              <div style={{display:"grid",gridTemplateColumns:"58% 42%",gap:"2px 0"}}>
                {/* Left */}
                <div style={{display:"flex",flexDirection:"column",gap:3}}>
                  {[["STUDENT'S NAME",s.name],["MOTHER'S NAME",s.mother],["FATHER'S NAME",s.father],["ADDRESS",s.address]].map(([l,v])=>(
                    <div key={l} style={{display:"flex",alignItems:"flex-start"}}>
                      <span style={{width:115,flexShrink:0}}>{l}</span>
                      <span style={{marginRight:4}}>:</span>
                      <span style={{textTransform:"uppercase",flex:1,wordBreak:"break-word"}}>{v}</span>
                    </div>
                  ))}
                </div>
                {/* C9: Right column ‚Äî labels left-aligned with consistent width */}
                <div style={{display:"flex",flexDirection:"column",gap:3,paddingLeft:10}}>
                  {[["ROLL NO.",s.roll],["ADMISSION NO.",s.admission],["DATE OF BIRTH",s.dob]].map(([l,v])=>(
                    <div key={l} style={{display:"flex",alignItems:"flex-start"}}>
                      <span style={{width:105,flexShrink:0}}>{l}</span>
                      <span style={{marginRight:4}}>:</span>
                      <span style={{fontWeight:900}}>{v}</span>
                    </div>
                  ))}
                </div>
              </div>
            </div>

            {/* ‚îÄ‚îÄ MARKS TABLE ‚îÄ‚îÄ */}
            <table style={{width:"100%",borderCollapse:"collapse",fontSize:9.5,marginBottom:4,tableLayout:"fixed"}}>
              <colgroup>
                <col style={{width:"20%"}}/><col style={{width:"6%"}}/><col style={{width:"9%"}}/>
                <col style={{width:"6%"}}/><col style={{width:"9%"}}/>
                <col style={{width:"6%"}}/><col style={{width:"9%"}}/>
                <col style={{width:"6%"}}/><col style={{width:"10%"}}/><col style={{width:"7%"}}/>
              </colgroup>
              <thead>
                <tr style={{background:"#fce4d6",height:26}}>
                  <TH s={{border:"1px solid #000",textAlign:"left",paddingLeft:4,fontWeight:800,fontSize:10}} c="SUBJECTS"/>
                  <TH s={{border:"1px solid #000",color:"#1a237e",fontWeight:700,fontSize:9}} c="FIRST TERM EXAM"/>
                  <TH s={{border:"1px solid #000",display:"none"}} c=""/>
                  <TH s={{border:"1px solid #000",color:"#1a237e",fontWeight:700,fontSize:9}} c="SECOND TERM EXAM"/>
                  <TH s={{border:"1px solid #000",display:"none"}} c=""/>
                  <TH s={{border:"1px solid #000",color:"#1a237e",fontWeight:700,fontSize:9}} c="THIRD TERM EXAM"/>
                  <TH s={{border:"1px solid #000",display:"none"}} c=""/>
                  <TH s={{border:"1px solid #000",color:"#1a237e",fontWeight:700,fontSize:9}} c="GRAND TOTAL"/>
                  <TH s={{border:"1px solid #000",display:"none"}} c=""/>
                  <TH s={{border:"1px solid #000",fontWeight:700,fontSize:9}} c="GRADE"/>
                </tr>
              </thead>
              <tbody>
                {/* Use proper rowSpan header */}
              </tbody>
            </table>

            {/* Proper marks table with rowSpan */}
            <table style={{width:"100%",borderCollapse:"collapse",fontSize:9.5,marginBottom:4,tableLayout:"fixed",marginTop:-4}}>
              <colgroup>
                <col style={{width:"20%"}}/><col style={{width:"6%"}}/><col style={{width:"9%"}}/>
                <col style={{width:"6%"}}/><col style={{width:"9%"}}/>
                <col style={{width:"6%"}}/><col style={{width:"9%"}}/>
                <col style={{width:"6%"}}/><col style={{width:"10%"}}/><col style={{width:"7%"}}/>
              </colgroup>
              <thead>
                <tr style={{background:"#fce4d6",height:26}}>
                  <th rowSpan="2" style={{border:"1px solid #000",textAlign:"left",paddingLeft:4,fontWeight:800,fontSize:10}}>SUBJECTS</th>
                  <th colSpan="2" style={{border:"1px solid #000",color:"#1a237e",fontWeight:700,fontSize:9}}>FIRST TERM EXAM</th>
                  <th colSpan="2" style={{border:"1px solid #000",color:"#1a237e",fontWeight:700,fontSize:9}}>SECOND TERM EXAM</th>
                  <th colSpan="2" style={{border:"1px solid #000",color:"#1a237e",fontWeight:700,fontSize:9}}>THIRD TERM EXAM</th>
                  <th colSpan="2" style={{border:"1px solid #000",color:"#1a237e",fontWeight:700,fontSize:9}}>GRAND TOTAL</th>
                  <th rowSpan="2" style={{border:"1px solid #000",fontWeight:700,fontSize:9,textAlign:"center"}}>GRADE</th>
                </tr>
                <tr style={{background:"#fce4d6",height:20}}>
                  {["MM","MARKS OBT","MM","MARKS OBT","MM","MARKS OBT","MM","TOTAL"].map((h,i)=>(
                    <th key={i} style={{border:"1px solid #000",color:i%2===0?"#0070c0":"#333",fontWeight:700,fontSize:8,padding:"1px",textAlign:"center"}}>{h}</th>
                  ))}
                </tr>
              </thead>
              <tbody>
                {s.subjects.map((sub,i)=>{
                  const tot=sTot(sub),mm=sMM(sub);
                  const p=mm>0?calcP(tot,mm):null;
                  return(
                    <tr key={i} style={{height:23,background:i%2===0?"#fff":"#fafafa"}}>
                      <td style={{border:"1px solid #000",paddingLeft:4,fontWeight:700,textTransform:"uppercase",fontSize:9.5,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}>{sub.name}</td>
                      <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0",fontWeight:700}}>{sub.mm1}</td>
                      <td style={{border:"1px solid #000",textAlign:"center",fontWeight:600}}>{sub.obt1}</td>
                      <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0",fontWeight:700}}>{sub.mm2}</td>
                      <td style={{border:"1px solid #000",textAlign:"center",fontWeight:600}}>{sub.obt2}</td>
                      <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0",fontWeight:700}}>{sub.mm3}</td>
                      <td style={{border:"1px solid #000",textAlign:"center",fontWeight:600}}>{sub.obt3}</td>
                      <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0",fontWeight:700}}>{mm>0?mm:""}</td>
                      <td style={{border:"1px solid #000",textAlign:"center",fontWeight:800}}>{mm>0?tot:""}</td>
                      <td style={{border:"1px solid #000",textAlign:"center",fontWeight:900,fontSize:10,color:p!==null&&p<33?"#c62828":"#1a237e"}}>{p!==null?getG(p):""}</td>
                    </tr>
                  );
                })}
                {/* C3: Only pad to 8 rows total ‚Äî no extra blank rows */}
                {[...Array(pad)].map((_,i)=>(
                  <tr key={"p"+i} style={{height:23}}>
                    {[...Array(10)].map((_,j)=><td key={j} style={{border:"1px solid #000"}}></td>)}
                  </tr>
                ))}
                {/* TOTAL row */}
                <tr style={{background:"#f2f2f2",fontWeight:800,height:24,fontSize:9.5}}>
                  <td style={{border:"1px solid #000",paddingLeft:4}}>TOTAL</td>
                  <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0"}}>{gt.mm1}</td>
                  <td style={{border:"1px solid #000",textAlign:"center"}}>{gt.obt1||""}</td>
                  <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0"}}>{gt.mm2}</td>
                  <td style={{border:"1px solid #000",textAlign:"center"}}>{gt.obt2||""}</td>
                  <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0"}}>{gt.mm3}</td>
                  <td style={{border:"1px solid #000",textAlign:"center"}}>{gt.obt3||""}</td>
                  <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0"}}>{gt.mmG}</td>
                  <td style={{border:"1px solid #000",textAlign:"center"}}>{gt.obtG}</td>
                  <td style={{border:"1px solid #000"}}></td>
                </tr>
                {/* PERCENTAGE row */}
                <tr style={{background:"#f2f2f2",fontWeight:800,height:24,fontSize:9.5}}>
                  <td style={{border:"1px solid #000",paddingLeft:4}}>PERCENTAGE</td>
                  <td colSpan="2" style={{border:"1px solid #000",textAlign:"center"}}>{gt.mm1>0?((gt.obt1/gt.mm1)*100).toFixed(0)+"%":""}</td>
                  <td colSpan="2" style={{border:"1px solid #000",textAlign:"center"}}>{gt.mm2>0?((gt.obt2/gt.mm2)*100).toFixed(0)+"%":""}</td>
                  <td colSpan="2" style={{border:"1px solid #000",textAlign:"center"}}>{gt.mm3>0?((gt.obt3/gt.mm3)*100).toFixed(0)+"%":""}</td>
                  <td colSpan="2" style={{border:"1px solid #000",textAlign:"center",fontSize:13,fontWeight:900}}>{op}%</td>
                  <td style={{border:"1px solid #000",textAlign:"center",fontWeight:900,fontSize:11,color:"#1a237e"}}>{getG(op)}</td>
                </tr>
              </tbody>
            </table>

            {/* CO-SCHOLASTIC */}
            <div style={{background:"#fce4d6",fontWeight:700,fontSize:9,padding:"3px 5px",border:"1px solid #000",display:"flex",justifyContent:"space-between",marginBottom:3}}>
              <span>Co-Scholastic Area</span>
              <span>A+:OUTSTANDING ¬∑ A:EXCELLENT ¬∑ B+:VERY GOOD ¬∑ B:GOOD ¬∑ C:AVERAGE</span>
            </div>
            <table style={{width:"100%",borderCollapse:"collapse",fontSize:9,marginBottom:4}}>
              <tbody>
                <tr style={{height:22}}>
                  {[["Sports & Games","sports"],["Art & Craft","art"],["Music & Dance","music"],["Discipline","discipline"],["Cleanliness","cleanliness"]].map(([l,k])=>(
                    <React.Fragment key={k}>
                      <td style={{border:"1px solid #000",padding:"2px 4px",fontWeight:700,background:"#fafafa"}}>{l}</td>
                      <td style={{border:"1px solid #000",textAlign:"center",fontWeight:900,color:"#1a237e",width:"5%"}}>{s.coscho[k]||""}</td>
                    </React.Fragment>
                  ))}
                </tr>
              </tbody>
            </table>

            {/* GRADE SCALE */}
            <div style={{display:"flex",border:"1px solid #000",marginBottom:6,height:24,fontSize:8.5}}>
              <div style={{background:"#595959",color:"#fff",fontWeight:700,width:"13%",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",padding:"0 3px",lineHeight:1.2,fontSize:8}}>MARK RANGE: GRADE</div>
              <div style={{flex:1,display:"flex"}}>
                {GRADES.map((g,i)=>(
                  <div key={i} style={{flex:1,background:"#dbe5f1",borderLeft:"1px solid #fff",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:600,fontSize:8}}>
                    {g.min===0?"00":g.min}-{g.max}:{g.g}
                  </div>
                ))}
              </div>
            </div>

            {/* C5: Remark / Rank / Attendance ‚Äî proper 3-column layout */}
            {/* C6: NO Result: PASS section */}
            <div style={{display:"grid",gridTemplateColumns:"1fr 120px 1fr",gap:10,alignItems:"flex-end",marginBottom:7,padding:"0 2px",fontSize:10.5,fontWeight:700}}>
              <div style={{display:"flex",alignItems:"flex-end",gap:4}}>
                <span style={{whiteSpace:"nowrap"}}>Remark :</span>
                <span style={{borderBottom:"1px solid #000",flex:1,paddingBottom:1,minWidth:60,fontSize:10}}>{s.remarks}</span>
              </div>
              <div style={{display:"flex",alignItems:"flex-end",gap:4,justifyContent:"center"}}>
                <span>Rank :</span>
                <span style={{borderBottom:"1px solid #000",minWidth:40,textAlign:"center",paddingBottom:1}}>{s.rank||""}</span>
              </div>
              <div style={{display:"flex",alignItems:"flex-end",gap:4,justifyContent:"flex-end"}}>
                <span style={{whiteSpace:"nowrap"}}>Attendance :</span>
                <span style={{borderBottom:"1px solid #000",minWidth:50,paddingBottom:1}}>{attDisp}</span>
              </div>
            </div>

            {/* SIGNATURES */}
            <div style={{marginTop:"auto",display:"flex",justifyContent:"space-between",paddingBottom:4,fontSize:10.5,fontWeight:700,padding:"10px 20px 4px"}}>
              {["Date","Class Teacher","Principal"].map(l=>(
                <div key={l} style={{textAlign:"center"}}>
                  <div style={{borderTop:"2px dotted #000",width:115,marginBottom:3}}></div>{l}
                </div>
              ))}
            </div>

          </div>{/* inner border */}
        </div>{/* red border */}
      </div>{/* PA */}
    </div>
  );
}

/* ---------- DESKTOP MINI PREVIEW ---------- */
function MiniPreview({s}){
  if(!s)return(
    <div style={{color:"#ccc",textAlign:"center",marginTop:60}}>
      <div style={{fontSize:44,marginBottom:12}}>üìÑ</div>
      <div style={{fontSize:13}}>Select a student to preview</div>
    </div>
  );
  const gt=gTot(s.subjects);
  const op=gt.mmG>0?calcP(gt.obtG,gt.mmG):null;
  const attDisp=s.att.present&&s.att.total?((s.att.present/s.att.total)*100).toFixed(0)+"%":"";
  const pad=Math.max(0,8-s.subjects.length);
  const sc=0.62;
  return(
    <div style={{transform:`scale(${sc})`,transformOrigin:"top center",marginBottom:`-${(1-sc)*297*sc*1.5}mm`}}>
      <div style={{width:"210mm",height:"297mm",background:"white",overflow:"hidden",fontFamily:"Arial,sans-serif",boxShadow:"0 8px 40px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column"}}>
        <div style={{border:"4px solid #c62828",margin:"5mm",flex:1,display:"flex",flexDirection:"column",overflow:"hidden"}}>
          <div style={{border:"1.5px solid #000",margin:"2px",flex:1,display:"flex",flexDirection:"column",padding:"5px 7px",overflow:"hidden"}}>
            {/* mini header */}
            <div style={{display:"flex",alignItems:"flex-start",gap:6,marginBottom:5}}>
              <div style={{width:82,height:82,border:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,marginTop:6,marginLeft:2}}>
                <img src={SLOGO} style={{width:"100%",height:"100%",objectFit:"contain"}} alt="" onError={e=>{e.target.style.display="none";}}/>
              </div>
              <div style={{flex:1,textAlign:"center",padding:"0 8px"}}>
                <div style={{fontSize:24,fontWeight:900,color:"#c62828",fontFamily:"serif"}}>{SNAME}</div>
                <div style={{fontSize:10,fontWeight:700}}>{SADDR}</div>
                <div style={{display:"inline-block",background:"#ffff00",color:"#c62828",padding:"2px 14px",fontWeight:900,fontSize:11.5,borderBottom:"2px solid #c62828",marginTop:5,marginBottom:3}}>PROGRESS EVALUATION REPORT</div>
                <div style={{fontSize:11,fontWeight:700,color:"#1a237e",marginTop:2}}>ACADEMIC SESSION : <span style={{color:"#000"}}>{s.session}</span></div>
                <div style={{fontSize:12,fontWeight:900}}>CLASS : {s.cls}{s.section?"-"+s.section:""}</div>
              </div>
              <div style={{width:74,height:88,border:"1.5px solid #000",flexShrink:0,overflow:"hidden",background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center",marginTop:10,marginRight:3}}>
                {s.photo?<img src={s.photo} style={{width:"100%",height:"100%",objectFit:"cover"}}/>:<span style={{fontSize:9,color:"#aaa"}}>Photo</span>}
              </div>
            </div>
            {/* student info */}
            <div style={{background:"#d1eeee",borderTop:"2px solid #000",borderBottom:"2px solid #000",padding:"5px 8px",marginBottom:5,fontSize:10.5,fontWeight:700,fontFamily:"serif"}}>
              <div style={{display:"grid",gridTemplateColumns:"58% 42%",gap:"2px 0"}}>
                <div style={{display:"flex",flexDirection:"column",gap:3}}>
                  {[["STUDENT'S NAME",s.name],["MOTHER'S NAME",s.mother],["FATHER'S NAME",s.father],["ADDRESS",s.address]].map(([l,v])=>(
                    <div key={l} style={{display:"flex"}}><span style={{width:115,flexShrink:0}}>{l}</span><span style={{marginRight:3}}>:</span><span style={{textTransform:"uppercase"}}>{v}</span></div>
                  ))}
                </div>
                <div style={{display:"flex",flexDirection:"column",gap:3,paddingLeft:10}}>
                  {[["ROLL NO.",s.roll],["ADMISSION NO.",s.admission],["DATE OF BIRTH",s.dob]].map(([l,v])=>(
                    <div key={l} style={{display:"flex"}}><span style={{width:105,flexShrink:0}}>{l}</span><span style={{marginRight:3}}>:</span><span style={{fontWeight:900}}>{v}</span></div>
                  ))}
                </div>
              </div>
            </div>
            {/* marks mini */}
            <table style={{width:"100%",borderCollapse:"collapse",fontSize:9.5,marginBottom:4,tableLayout:"fixed"}}>
              <colgroup><col style={{width:"20%"}}/><col style={{width:"6%"}}/><col style={{width:"9%"}}/><col style={{width:"6%"}}/><col style={{width:"9%"}}/><col style={{width:"6%"}}/><col style={{width:"9%"}}/><col style={{width:"6%"}}/><col style={{width:"10%"}}/><col style={{width:"7%"}}/></colgroup>
              <thead>
                <tr style={{background:"#fce4d6",height:26}}>
                  <th rowSpan="2" style={{border:"1px solid #000",textAlign:"left",paddingLeft:4,fontWeight:800,fontSize:10}}>SUBJECTS</th>
                  <th colSpan="2" style={{border:"1px solid #000",color:"#1a237e",fontWeight:700,fontSize:9}}>FIRST TERM</th>
                  <th colSpan="2" style={{border:"1px solid #000",color:"#1a237e",fontWeight:700,fontSize:9}}>SECOND TERM</th>
                  <th colSpan="2" style={{border:"1px solid #000",color:"#1a237e",fontWeight:700,fontSize:9}}>THIRD TERM</th>
                  <th colSpan="2" style={{border:"1px solid #000",color:"#1a237e",fontWeight:700,fontSize:9}}>GRAND TOTAL</th>
                  <th rowSpan="2" style={{border:"1px solid #000",fontWeight:700,fontSize:9}}>GRD</th>
                </tr>
                <tr style={{background:"#fce4d6",height:20}}>
                  {["MM","OBT","MM","OBT","MM","OBT","MM","TOT"].map((h,i)=>(
                    <th key={i} style={{border:"1px solid #000",color:i%2===0?"#0070c0":"#333",fontWeight:700,fontSize:8,textAlign:"center"}}>{h}</th>
                  ))}
                </tr>
              </thead>
              <tbody>
                {s.subjects.map((sub,i)=>{
                  const tot=sTot(sub),mm=sMM(sub),p=mm>0?calcP(tot,mm):null;
                  return(
                    <tr key={i} style={{height:23,background:i%2===0?"#fff":"#fafafa"}}>
                      <td style={{border:"1px solid #000",paddingLeft:3,fontWeight:700,textTransform:"uppercase",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}}>{sub.name}</td>
                      <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0"}}>{sub.mm1}</td><td style={{border:"1px solid #000",textAlign:"center"}}>{sub.obt1}</td>
                      <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0"}}>{sub.mm2}</td><td style={{border:"1px solid #000",textAlign:"center"}}>{sub.obt2}</td>
                      <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0"}}>{sub.mm3}</td><td style={{border:"1px solid #000",textAlign:"center"}}>{sub.obt3}</td>
                      <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0"}}>{mm>0?mm:""}</td><td style={{border:"1px solid #000",textAlign:"center",fontWeight:700}}>{mm>0?tot:""}</td>
                      <td style={{border:"1px solid #000",textAlign:"center",fontWeight:900,color:p!==null&&p<33?"#c62828":"#1a237e"}}>{p!==null?getG(p):""}</td>
                    </tr>
                  );
                })}
                {[...Array(pad)].map((_,i)=><tr key={"p"+i} style={{height:23}}>{[...Array(10)].map((_,j)=><td key={j} style={{border:"1px solid #000"}}></td>)}</tr>)}
                <tr style={{background:"#f2f2f2",fontWeight:800,height:24,fontSize:9.5}}>
                  <td style={{border:"1px solid #000",paddingLeft:3}}>TOTAL</td>
                  <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0"}}>{gt.mm1}</td><td style={{border:"1px solid #000",textAlign:"center"}}>{gt.obt1||""}</td>
                  <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0"}}>{gt.mm2}</td><td style={{border:"1px solid #000",textAlign:"center"}}>{gt.obt2||""}</td>
                  <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0"}}>{gt.mm3}</td><td style={{border:"1px solid #000",textAlign:"center"}}>{gt.obt3||""}</td>
                  <td style={{border:"1px solid #000",textAlign:"center",color:"#0070c0"}}>{gt.mmG}</td><td style={{border:"1px solid #000",textAlign:"center"}}>{gt.obtG}</td>
                  <td style={{border:"1px solid #000"}}></td>
                </tr>
                <tr style={{background:"#f2f2f2",fontWeight:800,height:24,fontSize:9.5}}>
                  <td style={{border:"1px solid #000",paddingLeft:3}}>PERCENTAGE</td>
                  <td colSpan="2" style={{border:"1px solid #000",textAlign:"center"}}>{gt.mm1>0?((gt.obt1/gt.mm1)*100).toFixed(0)+"%":""}</td>
                  <td colSpan="2" style={{border:"1px solid #000",textAlign:"center"}}>{gt.mm2>0?((gt.obt2/gt.mm2)*100).toFixed(0)+"%":""}</td>
                  <td colSpan="2" style={{border:"1px solid #000",textAlign:"center"}}>{gt.mm3>0?((gt.obt3/gt.mm3)*100).toFixed(0)+"%":""}</td>
                  <td colSpan="2" style={{border:"1px solid #000",textAlign:"center",fontSize:13,fontWeight:900}}>{op}%</td>
                  <td style={{border:"1px solid #000",textAlign:"center",fontWeight:900,color:"#1a237e"}}>{getG(op)}</td>
                </tr>
              </tbody>
            </table>
            {/* co-scho mini */}
            <div style={{background:"#fce4d6",fontWeight:700,fontSize:9,padding:"3px 5px",border:"1px solid #000",marginBottom:3}}>Co-Scholastic Area</div>
            <table style={{width:"100%",borderCollapse:"collapse",fontSize:9,marginBottom:4}}>
              <tbody><tr style={{height:22}}>{[["Sports","sports"],["Art","art"],["Music","music"],["Discipline","discipline"],["Cleanliness","cleanliness"]].map(([l,k])=>(<React.Fragment key={k}><td style={{border:"1px solid #000",padding:"2px 4px",fontWeight:700,background:"#fafafa"}}>{l}</td><td style={{border:"1px solid #000",textAlign:"center",fontWeight:900,color:"#1a237e",width:"6%"}}>{s.coscho[k]||""}</td></React.Fragment>))}</tr></tbody>
            </table>
            {/* grade scale mini */}
            <div style={{display:"flex",border:"1px solid #000",marginBottom:5,height:24,fontSize:8}}>
              <div style={{background:"#595959",color:"#fff",fontWeight:700,width:"13%",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",fontSize:7}}>MARK RANGE</div>
              <div style={{flex:1,display:"flex"}}>{GRADES.map((g,i)=><div key={i} style={{flex:1,background:"#dbe5f1",borderLeft:"1px solid #fff",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:600}}>{g.min===0?"00":g.min}-{g.max}:{g.g}</div>)}</div>
            </div>
            {/* footer mini */}
            <div style={{display:"grid",gridTemplateColumns:"1fr 120px 1fr",gap:10,alignItems:"flex-end",marginBottom:6,fontSize:10.5,fontWeight:700}}>
              <div style={{display:"flex",alignItems:"flex-end",gap:4}}><span>Remark :</span><span style={{borderBottom:"1px solid #000",flex:1}}>{s.remarks}</span></div>
              <div style={{display:"flex",alignItems:"flex-end",gap:4,justifyContent:"center"}}><span>Rank :</span><span style={{borderBottom:"1px solid #000",minWidth:40,textAlign:"center"}}>{s.rank||""}</span></div>
              <div style={{display:"flex",alignItems:"flex-end",gap:4,justifyContent:"flex-end"}}><span>Attendance :</span><span style={{borderBottom:"1px solid #000",minWidth:50}}>{attDisp}</span></div>
            </div>
            <div style={{marginTop:"auto",display:"flex",justifyContent:"space-between",fontSize:10.5,fontWeight:700,padding:"8px 18px 4px"}}>
              {["Date","Class Teacher","Principal"].map(l=><div key={l} style={{textAlign:"center"}}><div style={{borderTop:"2px dotted #000",width:110,marginBottom:3}}></div>{l}</div>)}
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

/* ---------- MAIN APP ---------- */
function App(){
  const [scr,setScr]=useState("dash");
  const [students,setStudents]=useState([]);
  const [aid,setAid]=useState(null);
  const [pst,setPst]=useState(null);
  const [prevSt,setPrevSt]=useState(null);
  const [toast,setToast]=useState("");
  const [syncSt,setSyncSt]=useState("idle");
  const [syncTs,setSyncTs]=useState("");
  const [loaded,setLoaded]=useState(false);

  const showToast=m=>{setToast(m);setTimeout(()=>setToast(""),2600);};

  useEffect(()=>{
    setSyncSt("syncing");
    fbAll().then(data=>{
      setStudents(data.length>0?data:lsL());
      setSyncSt("synced");setSyncTs(new Date().toLocaleTimeString("en-IN"));setLoaded(true);
    }).catch(()=>{
      setStudents(lsL());setSyncSt("offline");setLoaded(true);
      showToast("üì¥ Offline ‚Äì local storage loaded");
    });
  },[]);

  useEffect(()=>{if(loaded)lsS(students);},[students,loaded]);

  const handleSave=async u=>{
    const next=students.map(s=>s.id===u.id?u:s);
    setStudents(next);lsS(next);setPrevSt(u);
    setSyncSt("syncing");
    try{await fbSave(u);setSyncSt("synced");setSyncTs(new Date().toLocaleTimeString("en-IN"));}
    catch{setSyncSt("error");showToast("‚ö†Ô∏è Saved locally, sync failed");}
  };

  const handleNew=async()=>{
    const s=newSt();
    setStudents(p=>[...p,s]);
    setAid(s.id);setPrevSt(s);setScr("editor");
    try{await fbSave(s);}catch{}
  };

  const handleSel=id=>{
    setAid(id);
    const s=students.find(x=>x.id===id);
    setPrevSt(s);setScr("editor");
  };

  const handleDel=async()=>{
    if(!window.confirm("Delete this student permanently?"))return;
    const next=students.filter(s=>s.id!==aid);
    setStudents(next);lsS(next);setPrevSt(null);
    try{await fbDel(aid);}catch{}
    setScr("dash");showToast("üóëÔ∏è Deleted");
  };

  const active=students.find(s=>s.id===aid);
  const isDesktop=window.innerWidth>=900;

  if(!loaded)return(
    <div style={{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:14,background:"#eef0f5"}}>
      <div style={{fontSize:44}}>üè´</div>
      <div style={{fontWeight:700,color:"#1a237e",fontSize:18,fontFamily:"Playfair Display,serif"}}>{SNAME}</div>
      <div style={{color:"#888",fontSize:13,display:"flex",alignItems:"center",gap:8}}>
        <span style={{width:8,height:8,borderRadius:"50%",background:"#ff9800",display:"inline-block",animation:"pulse 1s infinite"}}></span>
        Loading from Firebase‚Ä¶
      </div>
    </div>
  );

  return(
    <div className={isDesktop?"shell":""}>
      <div className={isDesktop?"epane":""}>
        {scr==="dash"&&<Dashboard students={students} onNew={handleNew} onSel={handleSel} syncSt={syncSt} syncTs={syncTs}/>}
        {scr==="editor"&&active&&<Editor student={active} onSave={handleSave} onBack={()=>{setScr("dash");setPrevSt(null);}} onPrint={s=>{setPst(s);setScr("print");}} onDel={handleDel} toast={showToast}/>}
        {scr==="print"&&pst&&<PrintView student={pst} onClose={()=>setScr("editor")}/>}
      </div>
      {isDesktop&&scr!=="print"&&(
        <div className="ppane">
          <div style={{color:"#ddd",fontSize:11,marginBottom:12,letterSpacing:2}}>LIVE PREVIEW</div>
          <MiniPreview s={prevSt||active}/>
        </div>
      )}
      <Toast m={toast}/>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>

<script>
if('serviceWorker' in navigator){
  window.addEventListener('load',()=>{
    navigator.serviceWorker.register('sw.js').catch(()=>{});
  });
}
</script>
</body>
</html>
